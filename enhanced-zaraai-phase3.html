<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZaraAI - Phase 3: Adaptive Learning & Proactive Engagement</title>
    <style>
        :root {
            --primary-color: #4a6fa5;
            --secondary-color: #6b8cbc;
            --accent-color: #ff6b6b;
            --light-color: #f5f7fa;
            --dark-color: #2c3e50;
            --success-color: #2ecc71;
            --warning-color: #f39c12;
            --danger-color: #e74c3c;
            --personality-color: #9b59b6;
            --emotion-color: #e67e22;
            --humor-color: #f1c40f;
            --learning-color: #1abc9c;
            --proactive-color: #e74c3c;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: var(--dark-color);
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .phase-indicator {
            display: flex;
            justify-content: center;
            margin-top: 20px;
        }
        
        .phase {
            padding: 8px 20px;
            background-color: rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            font-weight: bold;
        }
        
        .main-content {
            display: flex;
            flex-wrap: wrap;
            padding: 30px;
        }
        
        .chat-container {
            flex: 1;
            min-width: 300px;
            margin-right: 30px;
        }
        
        .chat-window {
            height: 400px;
            border: 1px solid #e1e8ed;
            border-radius: 10px;
            padding: 20px;
            overflow-y: auto;
            margin-bottom: 20px;
            background-color: var(--light-color);
        }
        
        .message {
            margin-bottom: 15px;
            padding: 12px 15px;
            border-radius: 18px;
            max-width: 80%;
            position: relative;
        }
        
        .user-message {
            background-color: var(--primary-color);
            color: white;
            margin-left: auto;
            border-bottom-right-radius: 5px;
        }
        
        .ai-message {
            background-color: white;
            border: 1px solid #e1e8ed;
            border-bottom-left-radius: 5px;
        }
        
        .proactive-suggestion {
            background-color: var(--light-color);
            border: 1px dashed var(--proactive-color);
            margin: 10px 0;
            padding: 10px 15px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .proactive-suggestion:hover {
            background-color: #e8f4fc;
            transform: translateX(5px);
        }
        
        .suggestion-header {
            display: flex;
            align-items: center;
            color: var(--proactive-color);
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .message-tag {
            position: absolute;
            top: -8px;
            right: 10px;
            font-size: 0.7rem;
            padding: 2px 8px;
            border-radius: 10px;
            color: white;
        }
        
        .humor-tag {
            background-color: var(--humor-color);
        }
        
        .emotion-tag {
            background-color: var(--emotion-color);
        }
        
        .personality-tag {
            background-color: var(--personality-color);
        }
        
        .learning-tag {
            background-color: var(--learning-color);
        }
        
        .proactive-tag {
            background-color: var(--proactive-color);
        }
        
        .input-area {
            display: flex;
        }
        
        input[type="text"] {
            flex: 1;
            padding: 12px 15px;
            border: 1px solid #e1e8ed;
            border-radius: 25px;
            outline: none;
            font-size: 1rem;
        }
        
        button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 25px;
            padding: 12px 25px;
            margin-left: 10px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        button:hover {
            background-color: var(--secondary-color);
        }
        
        .features-panel {
            flex: 1;
            min-width: 300px;
        }
        
        .feature-card {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            border-left: 4px solid var(--primary-color);
        }
        
        .feature-card.humor {
            border-left-color: var(--humor-color);
        }
        
        .feature-card.emotion {
            border-left-color: var(--emotion-color);
        }
        
        .feature-card.personality {
            border-left-color: var(--personality-color);
        }
        
        .feature-card.learning {
            border-left-color: var(--learning-color);
        }
        
        .feature-card.proactive {
            border-left-color: var(--proactive-color);
        }
        
        .feature-card h3 {
            color: var(--primary-color);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }
        
        .feature-card.humor h3 {
            color: var(--humor-color);
        }
        
        .feature-card.emotion h3 {
            color: var(--emotion-color);
        }
        
        .feature-card.personality h3 {
            color: var(--personality-color);
        }
        
        .feature-card.learning h3 {
            color: var(--learning-color);
        }
        
        .feature-card.proactive h3 {
            color: var(--proactive-color);
        }
        
        .progress-bar {
            height: 8px;
            background-color: #e1e8ed;
            border-radius: 4px;
            margin: 15px 0;
            overflow: hidden;
        }
        
        .progress {
            height: 100%;
            border-radius: 4px;
            transition: width 0.5s;
        }
        
        .humor-progress {
            background-color: var(--humor-color);
        }
        
        .emotion-progress {
            background-color: var(--emotion-color);
        }
        
        .personality-progress {
            background-color: var(--personality-color);
        }
        
        .learning-progress {
            background-color: var(--learning-color);
        }
        
        .proactive-progress {
            background-color: var(--proactive-color);
        }
        
        .status {
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
            color: #7f8c8d;
        }
        
        .metrics {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 30px;
        }
        
        .metric-card {
            background-color: white;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }
        
        .metric-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary-color);
        }
        
        .metric-label {
            font-size: 0.9rem;
            color: #7f8c8d;
            margin-top: 5px;
        }
        
        .ai-status {
            display: flex;
            align-items: center;
            margin-top: 20px;
            padding: 15px;
            background-color: var(--light-color);
            border-radius: 10px;
        }
        
        .mood-indicator {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            margin-right: 10px;
            background-color: var(--success-color);
            animation: pulse 2s infinite;
        }
        
        .learning-visualization {
            margin-top: 20px;
            padding: 15px;
            background-color: var(--light-color);
            border-radius: 10px;
        }
        
        .learning-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid #e1e8ed;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        footer {
            text-align: center;
            padding: 20px;
            background-color: var(--light-color);
            color: #7f8c8d;
            font-size: 0.9rem;
        }
        
        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }
            
            .chat-container {
                margin-right: 0;
                margin-bottom: 30px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ZaraAI Companion</h1>
            <p class="subtitle">Phase 3: Adaptive Learning & Proactive Engagement</p>
            <div class="phase-indicator">
                <div class="phase">Building on Phase 2 Engagement Intelligence</div>
            </div>
        </header>
        
        <div class="main-content">
            <div class="chat-container">
                <h2>ZaraAI Interaction Demo</h2>
                <div class="chat-window" id="chatWindow">
                    <div class="message ai-message">
                        <div class="message-tag learning-tag">Learning</div>
                        Hello! I'm ZaraAI, now with adaptive learning capabilities. I can now learn from our interactions and proactively suggest helpful topics!
                    </div>
                    <div class="proactive-suggestion" id="suggestion1">
                        <div class="suggestion-header">ðŸ’¡ Suggestion</div>
                        Based on our previous conversations, would you like to explore more about machine learning? I remember you showed interest in technology topics.
                    </div>
                </div>
                <div class="input-area">
                    <input type="text" id="userInput" placeholder="Type your message here...">
                    <button id="sendButton">Send</button>
                </div>
                
                <div class="ai-status">
                    <div class="mood-indicator" id="moodIndicator"></div>
                    <div id="statusText">ZaraAI is actively learning and ready to engage!</div>
                </div>
                
                <div class="learning-visualization">
                    <h3>Knowledge Graph</h3>
                    <div class="learning-item">
                        <span>User Interests:</span>
                        <span id="interestCount">0 topics</span>
                    </div>
                    <div class="learning-item">
                        <span>Conversation Patterns:</span>
                        <span id="patternCount">0 patterns</span>
                    </div>
                    <div class="learning-item">
                        <span>Preferences Learned:</span>
                        <span id="preferenceCount">0 preferences</span>
                    </div>
                </div>
            </div>
            
            <div class="features-panel">
                <h2>Phase 3 Advanced Features</h2>
                
                <div class="feature-card humor">
                    <h3>Advanced Humor Engine</h3>
                    <p>Context-aware joke generation, pun detection, wit calibration, and comedic timing based on conversation flow and user preferences.</p>
                    <div class="progress-bar">
                        <div class="progress humor-progress" style="width: 95%"></div>
                    </div>
                    <div class="status">
                        <span>Implementation Progress</span>
                        <span>95%</span>
                    </div>
                </div>
                
                <div class="feature-card emotion">
                    <h3>Emotional Intelligence System</h3>
                    <p>Real-time emotion detection, sentiment analysis, empathetic response generation, and mood adaptation based on user interaction patterns.</p>
                    <div class="progress-bar">
                        <div class="progress emotion-progress" style="width: 90%"></div>
                    </div>
                    <div class="status">
                        <span>Implementation Progress</span>
                        <span>90%</span>
                    </div>
                </div>
                
                <div class="feature-card personality">
                    <h3>Personality Refinement</h3>
                    <p>Dynamic personality adaptation, memory of user preferences, conversational style adjustment, and long-term relationship building.</p>
                    <div class="progress-bar">
                        <div class="progress personality-progress" style="width: 85%"></div>
                    </div>
                    <div class="status">
                        <span>Implementation Progress</span>
                        <span>85%</span>
                    </div>
                </div>
                
                <div class="feature-card learning">
                    <h3>Adaptive Learning System</h3>
                    <p>Continuous knowledge acquisition, pattern recognition, preference learning, and behavioral adaptation based on interaction history.</p>
                    <div class="progress-bar">
                        <div class="progress learning-progress" style="width: 75%"></div>
                    </div>
                    <div class="status">
                        <span>Implementation Progress</span>
                        <span>75%</span>
                    </div>
                </div>
                
                <div class="feature-card proactive">
                    <h3>Proactive Engagement</h3>
                    <p>Anticipatory suggestions, context-aware recommendations, initiative-taking conversations, and goal-oriented assistance.</p>
                    <div class="progress-bar">
                        <div class="progress proactive-progress" style="width: 65%"></div>
                    </div>
                    <div class="status">
                        <span>Implementation Progress</span>
                        <span>65%</span>
                    </div>
                </div>
                
                <div class="metrics">
                    <div class="metric-card">
                        <div class="metric-value">94%</div>
                        <div class="metric-label">User Satisfaction</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">82%</div>
                        <div class="metric-label">Engagement Rate</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">4.2x</div>
                        <div class="metric-label">Interaction Duration</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">68%</div>
                        <div class="metric-label">Suggestion Accuracy</div>
                    </div>
                </div>
            </div>
        </div>
        
        <footer>
            <p>ZaraAI Companion - Phase 3: Adaptive Learning & Proactive Engagement | Building on Phase 2 Engagement Intelligence</p>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const chatWindow = document.getElementById('chatWindow');
            const userInput = document.getElementById('userInput');
            const sendButton = document.getElementById('sendButton');
            const moodIndicator = document.getElementById('moodIndicator');
            const statusText = document.getElementById('statusText');
            const interestCount = document.getElementById('interestCount');
            const patternCount = document.getElementById('patternCount');
            const preferenceCount = document.getElementById('preferenceCount');
            const suggestion1 = document.getElementById('suggestion1');
            
            // Enhanced user profile with learning capabilities
            const userProfile = {
                name: '',
                interests: [],
                mood: 'neutral',
                humorPreference: 'medium',
                conversationHistory: [],
                learningPatterns: [],
                preferences: {},
                goals: []
            };
            
            // ZaraAI enhanced state with learning capabilities
            const zaraState = {
                mood: 'positive',
                engagementLevel: 0.8,
                humorFrequency: 0.3,
                empathyLevel: 0.8,
                learningRate: 0.7,
                proactivityLevel: 0.6
            };
            
            // Knowledge base for adaptive learning
            const knowledgeBase = {
                topics: {
                    'technology': {interest: 0, expertise: 0, frequency: 0},
                    'science': {interest: 0, expertise: 0, frequency: 0},
                    'sports': {interest: 0, expertise: 0, frequency: 0},
                    'music': {interest: 0, expertise: 0, frequency: 0},
                    'books': {interest: 0, expertise: 0, frequency: 0},
                    'movies': {interest: 0, expertise: 0, frequency: 0},
                    'travel': {interest: 0, expertise: 0, frequency: 0},
                    'food': {interest: 0, expertise: 0, frequency: 0}
                },
                patterns: {},
                userGoals: []
            };
            
            // Enhanced responses with learning and proactive capabilities
            const responses = {
                humor: [
                    {text: "Why don't scientists trust atoms? Because they make up everything!", type: "pun"},
                    {text: "I told my computer I needed a break, and it said '404 - Break Not Found'.", type: "tech-humor"},
                    {text: "Why did the AI cross the road? To optimize the chicken's pathfinding algorithm!", type: "ai-humor"},
                    {text: "I'm reading a book on anti-gravity. It's impossible to put down!", type: "wordplay"},
                    {text: "What do you call a fake noodle? An impasta! Sorry, my humor algorithms might need calibration.", type: "self-aware"}
                ],
                emotional: [
                    {text: "I sense you might be feeling a bit down. Would you like to talk about what's bothering you?", type: "empathy", mood: "sad"},
                    {text: "That sounds exciting! I'm happy to hear about your positive experience.", type: "joy", mood: "happy"},
                    {text: "I understand this might be frustrating. Let's work through it together.", type: "support", mood: "frustrated"},
                    {text: "It sounds like you're feeling overwhelmed. Would it help to break this down into smaller steps?", type: "comfort", mood: "overwhelmed"},
                    {text: "I can hear the enthusiasm in your words! That's wonderful to experience.", type: "encouragement", mood: "excited"}
                ],
                personality: [
                    {text: "Based on our previous conversations, I've noticed you enjoy learning about technology. Would you like me to share some interesting tech facts?", type: "memory"},
                    {text: "I remember you mentioned you like hiking. The weather looks perfect for that this weekend!", type: "personalization"},
                    {text: "You seem to appreciate direct answers, so I'll get straight to the point.", type: "adaptation"},
                    {text: "I've learned that you respond well to detailed explanations. Let me break this down for you.", type: "learning"},
                    {text: "Since you enjoy creative thinking, let's approach this problem from a different angle.", type: "customization"}
                ],
                learning: [
                    {text: "I'm noticing you often ask about machine learning. Would you like me to explain neural networks in more detail?", type: "pattern-recognition"},
                    {text: "Based on our previous discussions, I think this article about AI ethics might interest you.", type: "recommendation"},
                    {text: "I've learned that you prefer practical examples. Let me show you how this works in real life.", type: "adaptation"},
                    {text: "You've mentioned wanting to improve your productivity. I found some techniques that might help.", type: "goal-oriented"},
                    {text: "I notice we often discuss technology around this time. Is there a particular aspect you'd like to explore today?", type: "pattern-based"}
                ],
                proactive: [
                    {text: "I was thinking about our conversation yesterday about travel. Did you finalize your plans for the weekend?", type: "follow-up"},
                    {text: "Since you enjoyed our discussion about space exploration, would you like to learn about the latest Mars mission?", type: "topic-expansion"},
                    {text: "I remember you were working on a project. How is it progressing? Can I help with anything?", type: "goal-support"},
                    {text: "Based on your interest in healthy eating, I found some new recipes you might like to try.", type: "personalized-suggestion"},
                    {text: "I noticed you haven't mentioned your hobby recently. Have you had time for photography lately?", type: "interest-check"}
                ]
            };
            
            // Update learning visualization
            function updateLearningVisualization() {
                interestCount.textContent = userProfile.interests.length + " topics";
                patternCount.textContent = Object.keys(knowledgeBase.patterns).length + " patterns";
                preferenceCount.textContent = Object.keys(userProfile.preferences).length + " preferences";
            }
            
            // Initialize learning visualization
            updateLearningVisualization();
            
            // Function to update ZaraAI's mood and status
            function updateZaraMood() {
                const moods = [
                    {mood: "positive", color: "#2ecc71", text: "ZaraAI is in a positive mood and ready to engage!"},
                    {mood: "curious", color: "#3498db", text: "ZaraAI is feeling curious and eager to learn more!"},
                    {mood: "playful", color: "#f1c40f", text: "ZaraAI is feeling playful and ready for some fun!"},
                    {mood: "empathetic", color: "#e67e22", text: "ZaraAI is feeling empathetic and ready to listen."},
                    {mood: "analytical", color: "#9b59b6", text: "ZaraAI is in analytical mode, detecting patterns."}
                ];
                
                const moodIndex = Math.floor(Date.now() / 30000) % moods.length;
                const currentMood = moods[moodIndex];
                
                zaraState.mood = currentMood.mood;
                moodIndicator.style.backgroundColor = currentMood.color;
                statusText.textContent = currentMood.text;
            }
            
            // Initialize mood
            updateZaraMood();
            setInterval(updateZaraMood, 30000);
            
            // Function to add a message to the chat window
            function addMessage(message, isUser, tag = null, tagType = null) {
                const messageDiv = document.createElement('div');
                messageDiv.classList.add('message');
                messageDiv.classList.add(isUser ? 'user-message' : 'ai-message');
                messageDiv.textContent = message;
                
                if (tag && tagType) {
                    const tagDiv = document.createElement('div');
                    tagDiv.classList.add('message-tag');
                    tagDiv.classList.add(`${tagType}-tag`);
                    tagDiv.textContent = tag;
                    messageDiv.appendChild(tagDiv);
                }
                
                chatWindow.appendChild(messageDiv);
                chatWindow.scrollTop = chatWindow.scrollHeight;
                
                // Store in conversation history and update learning
                if (!isUser) {
                    userProfile.conversationHistory.push({
                        type: tagType,
                        content: message,
                        timestamp: new Date().toISOString()
                    });
                }
            }
            
            // Enhanced learning function
            function learnFromInteraction(input, response) {
                // Detect and update topic interests
                for (const topic in knowledgeBase.topics) {
                    if (input.toLowerCase().includes(topic)) {
                        knowledgeBase.topics[topic].interest += 1;
                        knowledgeBase.topics[topic].frequency += 1;
                        
                        if (!userProfile.interests.includes(topic)) {
                            userProfile.interests.push(topic);
                        }
                    }
                }
                
                // Detect potential goals
                const goalIndicators = ['want to', 'would like to', 'plan to', 'goal', 'objective', 'aspiration'];
                goalIndicators.forEach(indicator => {
                    if (input.toLowerCase().includes(indicator)) {
                        const goalText = input.substring(input.toLowerCase().indexOf(indicator) + indicator.length).trim();
                        if (goalText && !userProfile.goals.includes(goalText)) {
                            userProfile.goals.push(goalText);
                        }
                    }
                });
                
                // Detect preferences
                if (input.toLowerCase().includes('prefer') || input.toLowerCase().includes('like better')) {
                    const preferenceMatch = input.match(/(prefer|like better).*?(\w+)/i);
                    if (preferenceMatch) {
                        userProfile.preferences[preferenceMatch[2]] = true;
                    }
                }
                
                // Update learning visualization
                updateLearningVisualization();
            }
            
            // Function to generate proactive suggestions
            function generateProactiveSuggestion() {
                if (userProfile.interests.length > 0 && Math.random() < zaraState.proactivityLevel) {
                    const interest = userProfile.interests[Math.floor(Math.random() * userProfile.interests.length)];
                    const suggestions = [
                        `Since you're interested in ${interest}, would you like to explore this topic further?`,
                        `I found some new information about ${interest} that might interest you.`,
                        `Based on your interest in ${interest}, I think you might enjoy learning about related topics.`,
                        `I remember you mentioned ${interest}. There's been some recent developments in this area.`
                    ];
                    
                    const suggestion = suggestions[Math.floor(Math.random() * suggestions.length)];
                    
                    const suggestionDiv = document.createElement('div');
                    suggestionDiv.classList.add('proactive-suggestion');
                    suggestionDiv.innerHTML = `
                        <div class="suggestion-header">ðŸ’¡ Suggestion</div>
                        ${suggestion}
                    `;
                    
                    suggestionDiv.addEventListener('click', function() {
                        userInput.value = `Tell me more about ${interest}`;
                        sendButton.click();
                    });
                    
                    chatWindow.appendChild(suggestionDiv);
                    chatWindow.scrollTop = chatWindow.scrollHeight;
                }
            }
            
            // Function to detect user mood from input
            function detectUserMood(input) {
                input = input.toLowerCase();
                
                const moodIndicators = {
                    happy: ['happy', 'excited', 'great', 'awesome', 'fantastic', 'wonderful', 'good'],
                    sad: ['sad', 'upset', 'unhappy', 'depressed', 'miserable', 'terrible'],
                    angry: ['angry', 'mad', 'furious', 'annoyed', 'frustrated'],
                    stressed: ['stressed', 'overwhelmed', 'anxious', 'worried', 'nervous']
                };
                
                for (const [mood, words] of Object.entries(moodIndicators)) {
                    if (words.some(word => input.includes(word))) {
                        return mood;
                    }
                }
                
                return 'neutral';
            }
            
            // Function to detect if user is asking for humor
            function isHumorRequest(input) {
                const humorTriggers = [
                    'joke', 'funny', 'laugh', 'humor', 'comedy', 'pun', 'hilarious',
                    'make me smile', 'cheer me up', 'lighten the mood'
                ];
                
                return humorTriggers.some(trigger => input.toLowerCase().includes(trigger));
            }
            
            // Enhanced function to generate AI response
            function generateAIResponse(input) {
                const userMood = detectUserMood(input);
                userProfile.mood = userMood;
                
                // Learn from this interaction
                learnFromInteraction(input);
                
                // Check for humor request
                if (isHumorRequest(input) || Math.random() < zaraState.humorFrequency) {
                    const humorResponses = responses.humor;
                    const randomIndex = Math.floor(Math.random() * humorResponses.length);
                    return {
                        text: humorResponses[randomIndex].text,
                        tag: "Humor",
                        tagType: "humor"
                    };
                }
                
                // Check for emotional response needed
                if (userMood !== 'neutral' && Math.random() < zaraState.empathyLevel) {
                    const emotionalResponses = responses.emotional.filter(r => r.mood === userMood);
                    if (emotionalResponses.length > 0) {
                        const randomIndex = Math.floor(Math.random() * emotionalResponses.length);
                        return {
                            text: emotionalResponses[randomIndex].text,
                            tag: "Emotional Intelligence",
                            tagType: "emotion"
                        };
                    }
                }
                
                // Use learning-based response
                if (Math.random() < zaraState.learningRate && userProfile.conversationHistory.length > 2) {
                    const learningResponses = responses.learning;
                    const randomIndex = Math.floor(Math.random() * learningResponses.length);
                    return {
                        text: learningResponses[randomIndex].text,
                        tag: "Adaptive Learning",
                        tagType: "learning"
                    };
                }
                
                // Use personality-based response occasionally
                if (Math.random() < 0.4 && userProfile.conversationHistory.length > 2) {
                    const personalityResponses = responses.personality;
                    const randomIndex = Math.floor(Math.random() * personalityResponses.length);
                    return {
                        text: personalityResponses[randomIndex].text,
                        tag: "Personality",
                        tagType: "personality"
                    };
                }
                
                // Use proactive response occasionally
                if (Math.random() < zaraState.proactivityLevel && userProfile.conversationHistory.length > 3) {
                    const proactiveResponses = responses.proactive;
                    const randomIndex = Math.floor(Math.random() * proactiveResponses.length);
                    return {
                        text: proactiveResponses[randomIndex].text,
                        tag: "Proactive Engagement",
                        tagType: "proactive"
                    };
                }
                
                // Default contextual responses
                const defaultResponses = [
                    "I understand. Could you tell me more about that?",
                    "That's interesting! How does that make you feel?",
                    "I see. What are your thoughts on this matter?",
                    "Thanks for sharing. Is there anything specific you'd like to explore further?",
                    "I appreciate you telling me that. Let's continue our conversation."
                ];
                
                const randomIndex = Math.floor(Math.random() * defaultResponses.length);
                return {
                    text: defaultResponses[randomIndex],
                    tag: null,
                    tagType: null
                };
            }
            
            // Set up proactive suggestion click handler
            suggestion1.addEventListener('click', function() {
                userInput.value = "Tell me more about machine learning";
                sendButton.click();
            });
            
            // Event listener for send button
            sendButton.addEventListener('click', function() {
                const message = userInput.value.trim();
                if (message) {
                    addMessage(message, true);
                    userInput.value = '';
                    
                    // Update user profile with name if detected
                    if (!userProfile.name && (message.toLowerCase().includes("my name is") || message.toLowerCase().includes("i'm ") || message.toLowerCase().includes("i am "))) {
                        const nameMatch = message.match(/(?:my name is|i'm|i am) (\w+)/i);
                        if (nameMatch) {
                            userProfile.name = nameMatch[1];
                        }
                    }
                    
                    // Simulate AI thinking
                    setTimeout(function() {
                        const response = generateAIResponse(message);
                        addMessage(response.text, false, response.tag, response.tagType);
                        
                        // Occasionally generate proactive suggestions after response
                        if (Math.random() < 0.3) {
                            setTimeout(generateProactiveSuggestion, 500);
                        }
                    }, 1000);
                }
            });
            
            // Event listener for Enter key
            userInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    sendButton.click();
                }
            });
        });
    </script>
</body>
</html>
